---
import Layout from "@/layouts/Layout.astro";
---

<Layout title="Free AI Diagnostic" visioptPid={174}>
  <main class="bg-navy min-h-screen text-white">
    <section class="pt-16 md:pt-20 pb-12 md:pb-16">
      <section class="max-w-6xl mx-auto px-4">
        <div class="grid md:grid-cols-2 gap-8 md:gap-10 items-center">
          <div class="order-2 md:order-1 text-center md:text-left">
            <h1 class="text-2xl md:text-5xl font-bold text-yellow leading-tight">
              Find out how many leads you're losing if you're NOT embracing AI
            </h1>

            <!-- 3 Info Cards -->
            <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mt-8">
              <div class="diag-card">
                <div class="diag-card-inner">
                  <svg class="w-6 h-6 md:w-8 md:h-8 text-yellow mb-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/>
                  </svg>
                  <p class="text-white/80 text-xs md:text-sm leading-relaxed">
                    <span class="text-yellow font-bold">New business lost</span> to competitors from slow response times.
                  </p>
                </div>
              </div>

              <div class="diag-card">
                <div class="diag-card-inner">
                  <svg class="w-6 h-6 md:w-8 md:h-8 text-yellow mb-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="2" y1="12" x2="6" y2="12"/>
                    <circle cx="9" cy="12" r="3"/>
                    <line x1="12" y1="12" x2="16" y2="12"/>
                    <circle cx="19" cy="12" r="3"/>
                    <line x1="22" y1="12" x2="22" y2="12"/>
                  </svg>
                  <p class="text-white/80 text-xs md:text-sm leading-relaxed">
                    <span class="text-yellow font-bold">Handling time</span> vs <span class="text-yellow font-bold">deflection savings</span> â€” time and money reclaimable through automation.
                  </p>
                </div>
              </div>

              <div class="diag-card">
                <div class="diag-card-inner">
                  <svg class="w-6 h-6 md:w-8 md:h-8 text-yellow mb-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="8" cy="16" r="2"/>
                    <polyline points="6 16 10 8 14 12 18 4"/>
                    <polyline points="16 4 20 4 20 8"/>
                  </svg>
                  <p class="text-white/80 text-xs md:text-sm leading-relaxed">
                    The <span class="text-yellow font-bold">opportunity cost</span> of your current strategy on revenue and team efficiency.
                  </p>
                </div>
              </div>
            </div>

            <!-- CTA Text -->
            <p class="mt-8 text-base md:text-2xl font-bold text-yellow">
              Answer 15 questions to find out how many leads you're losing
            </p>
            <p class="mt-2 text-sm md:text-lg text-white/85 font-bold">
              Takes less than 3 minutes - Get immediate results - Completely free.
            </p>
          </div>

          <div class="order-1 md:order-2">
            <iframe
              id="scorecard-embed"
              src="https://assessment.humtech.ai/"
              title="HumTech Scorecard"
              style="width:100%;max-width:780px;height:900px;border:0;outline:0;box-shadow:none;background:transparent;display:block;margin:0 auto;"
              loading="lazy"
              scrolling="no">
            </iframe>
          </div>
        </div>
      </section>

    </section>
  </main>

  <style>
    .diag-card {
      position: relative;
      padding: 2px;
      border-radius: 12px;
      background: linear-gradient(135deg, rgba(216, 183, 67, 0.4), rgba(216, 183, 67, 0.1));
    }

    .diag-card-inner {
      background: #0c2240;
      border-radius: 10px;
      padding: 1.25rem;
      height: 100%;
      border: 1px solid rgba(216, 183, 67, 0.1);
    }
  </style>

  <script is:inline>
    (() => {
      const iframe = document.getElementById("scorecard-embed");
      if (!iframe) return;

      const getSubmissionId = (payload) => {
        if (!payload || typeof payload !== "object") return null;
        const keys = ["submission", "submissionId", "submission_id", "id"];
        for (const key of keys) {
          const value = payload[key];
          if (typeof value === "string" && value.trim()) return value.trim();
        }
        return null;
      };

      window.addEventListener("message", (event) => {
        if (event.origin !== "https://assessment.humtech.ai") return;
        let data = event.data;
        if (typeof data === "string") {
          try {
            data = JSON.parse(data);
          } catch {
            return;
          }
        }

        if (data && data.type === "humtech-scorecard-height") {
          const nextHeight = Number(data.height);
          if (!Number.isFinite(nextHeight) || nextHeight <= 0) return;
          iframe.style.height = `${Math.round(nextHeight)}px`;
          return;
        }

        const submission = getSubmissionId(data);
        if (submission) {
          window.location.assign(
            `/results?submission=${encodeURIComponent(submission)}`
          );
        }
      });
    })();
  </script>
</Layout>
